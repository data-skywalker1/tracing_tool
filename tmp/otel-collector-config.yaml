# /tmp/otel-collector-config.yaml
receivers:
  otlp:
    protocols:
      grpc:
        endpoint: 0.0.0.0:4317
      http:
        endpoint: 0.0.0.0:4318

exporters:
  # Debug exporter for local debugging
  debug:
    verbosity: detailed
  
  # Elasticsearch APM exporter via OTLP
  otlphttp/elastic:
    endpoint: "http://apm-server:8200"
    headers:
      # Authorization: Bearer <your-secret-token>  # Uncomment and add your APM secret token if needed
    compression: gzip

service:
  pipelines:
    traces:
      receivers: [otlp]
      exporters: [debug, otlphttp/elastic]
    metrics:
      receivers: [otlp]
      exporters: [debug, otlphttp/elastic]
    logs:
      receivers: [otlp]
      exporters: [debug, otlphttp/elastic]